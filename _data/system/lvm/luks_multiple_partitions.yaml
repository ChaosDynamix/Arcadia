has_raid            : !!bool false
has_encryption      : !!bool true
has_lvm             : !!bool true
has_swapfile        : !!bool false
has_encrypted_boot  : !!bool true
filesystem          : !!str ext4

# DEVICE TABLES
device_tables : !!map
  has_fstab               : !!bool false
  has_crypttab            : !!bool false
  has_crypttab_initramfs  : !!bool true
  crypttab_initramfs      : !!str |
                            cryptlvmUUID     UUID=device_UUID   /etc/luks-keys/cryptlvmUUID.keyfile
                            cryptlvmUUID     UUID=device_UUID   /etc/luks-keys/cryptlvmUUID.keyfile

# PACSTRAP
pacstrap  : !!map
  has_needed_packages : !!bool true
  needed_packages     : !!str lvm2

# MKINITCPIO
mkinitcpio  : !!map
  has_config  : !!bool true
  config      : !!str |
                FILES=(/etc/luks-keys/cryptlvmUUID.keyfile /etc/luks-keys/cryptlvmUUID.keyfile)
                HOOKS=(base systemd autodetect modconf block sd-encrypt sd-lvm2 filesystems keyboard sd-vconsole fsck)

# GRUB
grub  : !!map
  has_config  : !!bool true
  config      : !!str |
                GRUB_CMDLINE_LINUX_DEFAULT="rd.luks.options=discard root=/dev/grp/root loglevel=3 quiet"
                GRUB_ENABLE_CRYPTODISK=y

# STORAGE
sgdisk  : !!str |
          $ sgdisk -o _bootpart_ -n=2:0:0 -t=2:8309 /dev/sda
          $ sgdisk -o -n=1:0:0 -t=1:8309 /dev/sdb

devices : !!seq
  - !!map
    node  : !!str /dev/sda
  - !!map
    node  : !!str /dev/sdb

partitions  : !!seq
  - !!map
    node      : !!str /dev/sda1
    has_boot  : !!bool true
  - !!map
    node      : !!str /dev/sda2
    has_boot  : !!bool false
    type      : !!str Linux LUKS partition
    size      : !!str 100%FREE
  - !!map
    node      : !!str /dev/sdb1
    has_boot  : !!bool false
    type      : !!str Linux LUKS partition
    size      : !!str 100%FREE

# ENCRYPTION
containers  : !!seq
  - !!map
    page                : !!str Storage
    is_bootable         : !!bool true
    name                : !!str cryptlvmUUID
    node                : !!str /dev/sda2
    type                : !!str luks1
    has_detached_header : !!bool false
    has_keyfile         : !!bool true
    keyfile             : !!str /etc/luks-keys/cryptlvmUUID.keyfile
  - !!map
    page                : !!str Storage
    is_bootable         : !!bool true
    name                : !!str cryptlvmUUID
    node                : !!str /dev/sdb1
    type                : !!str luks1
    has_detached_header : !!bool false
    has_keyfile         : !!bool true
    keyfile             : !!str /etc/luks-keys/cryptlvmUUID.keyfile

# LOGICAL VOLUME MANAGER
lvm : !!map
  pv  : !!str /dev/mapper/cryptlvmUUID /dev/mapper/cryptlvmUUID
  vg  : !!str grp
  lvs : !!seq
    - !!map
      node  : !!str /dev/grp/root
      name  : !!str root
      size  : !!str "15-20 GiB"
    - !!map
      node  : !!str /dev/grp/swap
      name  : !!str swap
      size  : !!str "> 512 MiB"
    - !!map
      node  : !!str /dev/grp/var
      name  : !!str var
      size  : !!str "8-12 GiB"
    - !!map
      node  : !!str /dev/grp/home
      name  : !!str home
      size  : !!str "100%FREE - 5 GiB"

# FILESYSTEM
ext4  : !!map
  has_swap  : !!bool true
  elements  : !!seq
    - !!map
      page        : !!str Storage
      node        : !!str /dev/grp/root
      label       : !!str ROOT
      mountpoint  : !!str /mnt
      has_dir     : !!bool false
    - !!map
      page        : !!str Storage
      node        : !!str /dev/grp/swap
      label       : !!str SWAP
      mountpoint  : !!str none
      has_dir     : !!bool false
    - !!map
      page        : !!str Storage
      node        : !!str /dev/grp/var
      label       : !!str VAR
      mountpoint  : !!str /mnt/var
      has_dir     : !!bool true
      dir         : !!str var
    - !!map
      page        : !!str Storage
      node        : !!str /dev/grp/home
      label       : !!str HOME
      mountpoint  : !!str /mnt/home
      has_dir     : !!bool true
      dir         : !!str home

# TEXTS
txts : !!seq
  - !!map
    page    : !!str Storage
    include : !!map
      encryption_ctx  : !!str LUKS partitions
      filesystem_ctx  : !!str volumes
      efi_ctx         : !!str partition
