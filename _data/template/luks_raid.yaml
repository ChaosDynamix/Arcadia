####################################
# SCRIPT (MANDATORY)               #
####################################

sgdisk            : !!map
  has_fixed_size  : !!bool true
  script          : !!str |
                    $ sgdisk -o mode_sgdisk -n=2:0:-100M -t=2:fd00 -R=/dev/sdb /dev/sda
                    $ sgdisk -G /dev/sdb

####################################
# STORAGE (MANDATORY)              #
####################################

devices   : !!seq
  - !!map
    node  : !!str /dev/sda
  - !!map
    node  : !!str /dev/sdb

partitions: !!seq
  - !!map
    node  : !!str /dev/sda1
    boot  : !!bool true
    type  : !!str mode_partition_type
    size  : !!str mode_partition_size
  - !!map
    node  : !!str /dev/sda2
    boot  : !!bool false
    type  : !!str Linux RAID partition
    size  : !!str 100%FREE - 100M
  - !!map
    node  : !!str /dev/sdb1
    boot  : !!bool true
    type  : !!str mode_partition_type
    size  : !!str mode_partition_size
  - !!map
    node  : !!str /dev/sdb2
    boot  : !!bool false
    type  : !!str Linux RAID partition
    size  : !!str 100%FREE - 100M

efi       : !!map
  node    : !!str /dev/md/efi
  context : !!str Raid array

####################################
# RAID                             #
####################################

has_raid  : !!bool true

####################################
# ENCRYPTION                       #
####################################

has_encryption  : !!bool true

encryption      : !!map
  headerless    : !!bool false

  steps         : !!seq
    - !!map
      id        : !!int 1
      title     : !!str Encrypt the system Raid array

  containers    : !!seq
    - !!map
      step_id           : !!int 1
      is_headerless     : !!bool false
      is_bootable       : !!bool true
      has_password      : !!bool true
      has_keyfile       : !!bool true
      has_init_keyfile  : !!bool false
      name              : !!str cryptsystem
      node              : !!str /dev/md/system
      type              : !!str luks1
      keyfile           : !!str /etc/luks-keys/cryptsystem.keyfile
